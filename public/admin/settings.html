<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Codex-Coordinator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="dashboard.css?v=2025-12-09-02">
  <link rel="stylesheet" href="dashboard-mobile.css?v=2025-12-09-03">
</head>
<body data-view="desktop" data-view-mode="settings">
  <header class="main-nav">
    <div class="nav-brand">
      <img class="brand-logo" src="openai-logo.svg" alt="OpenAI logo">
      <div>
        <div class="brand-title">Codex Coordinator</div>
      </div>
    </div>
    <nav class="nav-groups">
      <a class="nav-item" href="/admin/?view=dashboard" data-nav="dashboard">Dashboard</a>
      <a class="nav-item" href="/admin/hosts.html" data-nav="hosts">Hosts</a>
      <a class="nav-item" href="/admin/logs.html" data-nav="logs">Logs</a>
      <a class="nav-item" href="/admin/settings.html" data-nav="settings">Settings</a>
    </nav>
    <div class="nav-actions">
      <button class="nav-btn primary" id="navNewHost">New host</button>
    </div>
  </header>
  <div class="app">
    <div class="content">
      <section class="page-hero">
        <div>
          <p class="eyebrow">Settings</p>
          <h1>Administration</h1>
          <p class="muted">One place for toggles, agents, slash commands, memories, and config.</p>
        </div>
      </section>
      <main class="main">
      <div class="host-tabs settings-tabs" role="tablist" aria-label="Settings tabs">
        <a class="host-tab settings-tab active" data-tab="settings" href="#settings">Settings</a>
        <a class="host-tab settings-tab" data-tab="agents" href="#agents">Agents</a>
        <a class="host-tab settings-tab" data-tab="prompts" href="#prompts">Slash commands</a>
        <a class="host-tab settings-tab" data-tab="memories" href="#memories">Memories</a>
        <a class="host-tab settings-tab" data-tab="config" href="#config">config.toml</a>
      </div>
      <div class="settings-pane active" data-pane="settings">
        <div class="modal-backdrop" id="seedModal">
          <div class="modal seed-modal">
            <h3>Initial seeding required</h3>
            <p class="muted" id="seedModalCopy">This installation has no hosts or canonical auth.json yet. Seed auth.json before issuing installers.</p>
            <div class="seed-status">
              <div class="seed-chip warn" id="seedHostsStatus"><span class="dot"></span>No hosts registered</div>
              <div class="seed-chip warn" id="seedAuthStatus"><span class="dot"></span>Canonical auth.json missing</div>
            </div>
            <div class="actions">
              <button class="ghost" id="seedDismissBtn">Close</button>
              <button id="seedUploadBtn">Seed auth.json</button>
            </div>
          </div>
        </div>
        <div class="modal-backdrop" id="newHostModal">
          <div class="modal">
            <h3>New Host</h3>
            <p>Issue a one-time installer link for this FQDN. The API key is baked in and bound to this host on first contact.</p>
            <div class="field">
              <label for="new-host-name" style="font-weight:600;">Host FQDN</label>
              <input id="new-host-name" type="text" placeholder="e.g. node-01.example.com">
            </div>
            <div class="field">
              <label class="toggle state-toggle" for="secureHostToggle">
                <input type="checkbox" id="secureHostToggle" checked>
                <span class="track"><span class="thumb"></span></span>
                <span class="toggle-text">Secure host (keep auth.json after runs)</span>
              </label>
              <p class="muted" style="margin:6px 0 0;">Off = treat as insecure; cdx removes auth.json after each run.</p>
            </div>
            <div class="field">
              <label class="toggle state-toggle" for="insecureToggle">
                <input type="checkbox" id="insecureToggle">
                <span class="track"><span class="thumb"></span></span>
                <span class="toggle-text">Allow insecure curl (-k)</span>
              </label>
            </div>
            <div class="field">
              <label class="toggle state-toggle" for="ipv4Toggle">
                <input type="checkbox" id="ipv4Toggle">
                <span class="track"><span class="thumb"></span></span>
                <span class="toggle-text">Force IPv4 (curl -4)</span>
              </label>
            </div>
            <div class="field">
              <label class="toggle state-toggle" for="vipToggle">
                <input type="checkbox" id="vipToggle">
                <span class="track"><span class="thumb"></span></span>
                <span class="toggle-text">VIP host (ignore quota kill switch)</span>
              </label>
            </div>
            <div class="field" id="commandField" style="display:none;">
              <label style="font-weight:600;">Run on the target host</label>
              <div class="command-box">
                <span class="cmd-text" id="bootstrapCmd"></span>
                <button class="copy-btn" id="copyCmd">Copy</button>
              </div>
              <p class="muted" id="installerMeta" style="margin-top:8px; display:none;"></p>
              <p class="muted" style="margin-top:8px;">Single command downloads the baked installer and configures the host.</p>
              </div>
            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:6px;">
              <button class="ghost" id="cancelNewHost">Cancel</button>
              <button id="createHost">Generate</button>
            </div>
          </div>
        </div>

        <div class="modal-backdrop" id="uploadModal">
          <div class="modal">
            <h3>Seed auth.json</h3>
            <p>Paste or choose an auth.json; it will be validated via the runner and stored as canonical.</p>
            <div class="field">
              <label for="uploadHostSelect" style="font-weight:600;">Store scope</label>
              <select id="uploadHostSelect"></select>
            </div>
            <div class="field">
              <label for="uploadAuthText" style="font-weight:600;">auth.json</label>
              <textarea id="uploadAuthText" rows="8" placeholder='{"last_refresh":"...","auths":{...}}'></textarea>
            </div>
            <div class="field">
              <label style="font-weight:600;">or choose file</label>
              <input type="file" id="uploadAuthFile" accept=".json,application/json">
            </div>
            <div id="uploadStatus" class="muted" style="min-height:18px; font-size:13px;"></div>
            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:6px;">
              <button class="ghost" id="uploadAuthCancel">Cancel</button>
              <button id="uploadAuthSubmit">Upload</button>
            </div>
          </div>
        </div>
        <div class="modal-backdrop" id="deleteHostModal">
          <div class="modal">
            <h3>Remove host</h3>
            <p id="delete-host-text" class="muted"></p>
            <div class="actions">
              <button class="ghost" id="cancelDeleteHost">Cancel</button>
              <button class="danger" id="confirmDeleteHost">Remove</button>
            </div>
          </div>
        </div>
        <div class="modal-backdrop" id="hostDetailModal">
          <div class="modal host-detail-modal">
            <div class="host-detail-head">
              <div>
                <p class="muted overline">Authorized Host</p>
                <h3 id="hostDetailTitle">Loading…</h3>
                <div class="chip-row" id="hostDetailPills"></div>
              </div>
              <div class="host-detail-head-actions">
                <button class="ghost tiny-btn" id="closeHostDetail">Close</button>
              </div>
            </div>
            <div class="host-detail-summary" id="hostDetailSummary"></div>
            <div class="kv-grid" id="hostDetailGrid"></div>
            <div class="host-detail-actions" id="hostDetailActions"></div>
          </div>
        </div>
        <div class="modal-backdrop" id="runnerModal">
          <div class="modal">
            <h3>Auth runner</h3>
            <p class="muted">Manual runner invocation with live output and the final decision.</p>
            <div class="runner-meta" id="runnerMeta"></div>
            <div class="runner-log" id="runnerLog" aria-live="polite"></div>
            <div class="actions">
              <button class="ghost" id="runnerClose">Close</button>
            </div>
          </div>
        </div>
        <div class="modal-backdrop" id="upgradeModal">
          <div class="modal">
            <h3>Codex Upgrade Notes</h3>
            <p class="muted" id="upgradeVersionLabel"></p>
            <div class="upgrade-notes" id="upgradeNotes">Loading…</div>
            <div class="actions">
              <button class="ghost" id="upgradeGithubLink" type="button">Open on GitHub</button>
              <button class="ghost" id="upgradeClose">Close</button>
            </div>
          </div>
        </div>

        <div class="modal-backdrop" id="usageHistoryModal">
          <div class="modal usage-history-modal">
            <div class="modal-head">
              <div>
                <h3>ChatGPT Quota Trend</h3>
                <p class="muted" id="usageHistorySubtitle">Loading…</p>
              </div>
              <button class="ghost tiny-btn" id="usageHistoryClose">Close</button>
            </div>
            <div class="usage-history-chart" id="usageHistoryChart">Loading…</div>
            <div class="muted" id="usageHistoryMeta" style="margin-top:8px;"></div>
          </div>
        </div>

        <div class="modal-backdrop" id="costHistoryModal">
          <div class="modal usage-history-modal">
            <div class="modal-head">
              <div>
                <h3>Cost Trend</h3>
                <p class="muted" id="costHistorySubtitle">Loading…</p>
              </div>
              <button class="ghost tiny-btn" id="costHistoryClose">Close</button>
            </div>
            <div class="usage-history-chart cost-history-chart" id="costHistoryChart">Loading…</div>
            <div class="muted" id="costHistoryMeta" style="margin-top:8px;"></div>
          </div>
        </div>

        <section class="grid metrics" id="stats"></section>

        <section class="card usage-card" id="chatgpt-usage-card">
          <div class="muted">Loading ChatGPT usage…</div>
        </section>

        <section class="card panel" id="passkey-panel">
          <div class="panel-head">
            <div>
              <h2>Passkey</h2>
              <p class="muted" style="margin:4px 0 0;">Dashboard passkey enrollment and latest auth state.</p>
            </div>
          </div>
          <div class="passkey-actions">
            <div>
              <div class="muted" style="font-weight:600;">Passkey enrollment</div>
              <div id="passkeyCreatedCell">Checking…</div>
            </div>
            <div>
              <div class="muted" style="font-weight:600;">Last auth attempt</div>
              <div id="passkeyAuthCell">Checking…</div>
            </div>
            <div class="passkey-buttons">
              <button class="nav-btn primary small" id="passkeyCreateBtn">Create</button>
              <button class="nav-btn ghost small" id="passkeyTestBtn">Test auth</button>
              <button class="nav-btn ghost small" id="passkeyRemoveBtn">Remove</button>
            </div>
          </div>
        </section>

        <section class="card panel" id="hosts-panel">
          <div class="panel-head">
            <div>
              <h2>Authorized Hosts</h2>
            </div>
            <div class="panel-actions">
              <input type="search" id="host-filter" placeholder="Search host, IP, or version">
            </div>
          </div>
          <div class="table-wrap">
            <table id="hosts">
              <thead>
                <tr>
                  <th data-sort-key="host"><span class="sort-link" role="button" tabindex="0" data-sort="host"><span>Host</span><span class="sort-indicator">↕</span></span></th>
                  <th data-sort-key="last_seen"><span class="sort-link" role="button" tabindex="0" data-sort="last_seen"><span>Last Seen</span><span class="sort-indicator">↕</span></span></th>
                  <th data-sort-key="client"><span class="sort-link" role="button" tabindex="0" data-sort="client"><span>Client</span><span class="sort-indicator">↕</span></span></th>
                  <th data-sort-key="wrapper"><span class="sort-link" role="button" tabindex="0" data-sort="wrapper"><span>Wrapper</span><span class="sort-indicator">↕</span></span></th>
                  <th data-sort-key="ip"><span class="sort-link" role="button" tabindex="0" data-sort="ip"><span>IP / Mode</span><span class="sort-indicator">↕</span></span></th>
                  <th class="insecure-col">Insecure API</th>
                </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
        </section>

        <section class="card panel" id="memories-panel">
          <div class="panel-head">
            <div>
              <h2>Memories</h2>
              <p class="muted" style="margin:4px 0 0;">Browse MCP memories stored by hosts.</p>
            </div>
            <div class="panel-actions" style="gap:10px;">
              <a class="ghost tiny-btn" href="/admin/mcp-logs.html" style="text-decoration:none;line-height:28px;">Access Logs</a>
              
              <button class="ghost tiny-btn" id="memoriesRefreshBtn">Refresh</button>
            </div>
          </div>
          <div class="memory-controls" id="memoriesFilters" hidden>
            <div class="field">
              <label for="memoriesQuery" style="font-weight:600;">Search</label>
              <input id="memoriesQuery" type="text" placeholder="Text search (optional)">
            </div>
            <div class="field narrow-field">
              <label for="memoriesHostFilter" style="font-weight:600;">Host</label>
              <select id="memoriesHostFilter">
                <option value="">All hosts</option>
              </select>
            </div>
            <div class="field">
              <label for="memoriesTags" style="font-weight:600;">Tags</label>
              <input id="memoriesTags" type="text" placeholder="tag1, tag2 (optional)">
            </div>
            <div class="field narrow-field">
              <label for="memoriesLimit" style="font-weight:600;">Limit</label>
              <input id="memoriesLimit" type="number" min="1" max="200" value="50">
            </div>
          </div>
          <div class="table-wrap" id="memoriesTableWrap" hidden>
            <table id="memories">
              <thead>
                <tr>
                  <th>Content</th>
                  <th>Tags</th>
                  <th>Updated</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>

        <section class="card panel settings-panel" id="settings-panel">
          <div class="panel-head">
            <div>
              <h2>Operations & Settings</h2>
              <p class="muted" style="margin:4px 0 0;">Emergency toggles and runner utilities.</p>
            </div>
            <div class="panel-actions">
              
            </div>
          </div>
          <div class="settings-grid">
            <div class="setting-block">
              <div class="setting-head">
                <div>
                  <h3>Quota Policy</h3>
                  <p class="muted quota-desc" style="margin:2px 0 0;">ChatGPT quota hit: deny Codex launch.</p>
                </div>
                <label class="toggle" for="quotaHardFailToggle">
                  <input type="checkbox" id="quotaHardFailToggle">
                  <span class="track"><span class="thumb"></span></span>
                  <span class="toggle-text" id="quotaModeLabel">Deny launches</span>
                </label>
              </div>
              <div class="quota-limit-control">
                <div class="quota-limit-head">
                  <p class="muted" style="margin:0;">Warn/kill at</p>
                  <div class="quota-limit-value" id="quotaLimitLabel">100%</div>
                </div>
                <input type="range" min="50" max="100" step="1" value="100" id="quotaLimitSlider" class="quota-limit-slider">
                <p class="muted quota-limit-foot">Used percent that triggers warnings (or failures when deny mode is on).</p>
              </div>
              <div class="quota-partition-control">
                <div class="quota-limit-head">
                  <p class="muted" style="margin:0;">Week partition</p>
                  <div class="quota-limit-value" id="quotaPartitionLabel">Off</div>
                </div>
                <select id="quotaPartitionSelect" class="quota-partition-select">
                  <option value="0">Off (default)</option>
                  <option value="7">7 days (100/7 daily)</option>
                  <option value="5">5 days: Mon-Fri (100/5 daily)</option>
                </select>
                <p class="muted quota-limit-foot">Adds a daily allowance bar in cdx; honours deny/warn mode.</p>
              </div>
            </div>
            <div class="setting-block">
              <div class="setting-head">
                <div>
                  <h3>API Kill Switch</h3>
                  <p class="muted" style="margin:2px 0 0;">Emergency stop for Codex agents.</p>
                </div>
                <label class="toggle" for="apiToggle">
                  <input type="checkbox" id="apiToggle">
                  <span class="track"><span class="thumb"></span></span>
                  <span class="toggle-text" id="apiToggleLabel">Enabled</span>
                </label>
              </div>
            </div>
            <div class="setting-block">
              <div class="setting-head">
                <div>
                  <h3>cdx Silent Mode</h3>
                  <p class="muted" style="margin:2px 0 0;">Hide wrapper boot logs; only errors print.</p>
                </div>
                <label class="toggle" for="cdxSilentToggle">
                  <input type="checkbox" id="cdxSilentToggle">
                  <span class="track"><span class="thumb"></span></span>
                  <span class="toggle-text" id="cdxSilentLabel">Verbose</span>
                </label>
              </div>
            </div>
            <div class="setting-block">
              <div class="setting-head">
                <div>
                  <h3>Insecure Host Window</h3>
                  <p class="muted" style="margin:2px 0 0;">Duration granted when enabling insecure hosts.</p>
                </div>
              </div>
              <div class="insecure-window-control">
                <div class="insecure-window-head">
                  <div>
                    <p class="muted insecure-window-copy">Applies to the next enable and persists locally.</p>
                  </div>
                  <div class="insecure-window-value" id="insecureWindowLabel">10 min</div>
                </div>
                <input type="range" min="2" max="60" step="1" value="10" id="insecureWindowSlider" class="insecure-window-slider">
                <div class="insecure-window-foot muted">Each `/auth` extends by this duration (2–60 minutes).</div>
              </div>
            </div>
            <div class="setting-block">
              <div class="setting-head">
                <div>
                  <h3>Maintenance</h3>
                  <p class="muted" style="margin:2px 0 0;">Run the runner, seed auth.json, or check versions.</p>
                </div>
              </div>
              <div class="setting-actions">
                <button class="ghost" id="uploadAuthBtn">Seed auth.json</button>
                <button class="ghost tiny-btn" id="runner-runner" title="Run auth-runner now">↻ Runner</button>
                <button class="ghost" id="version-check">Check versions</button>
              </div>
            </div>

            <div class="setting-block">
              <div class="setting-head">
                <div>
                  <h3>config.toml Generator</h3>
                  <p class="muted" style="margin:2px 0 0;">Render and download the host config with managed MCP baked in.</p>
                </div>
              </div>
              <div class="setting-actions">
                <button class="ghost" type="button" onclick="window.location.href='/admin/config.html'">Open generator</button>
              </div>
            </div>
          </div>
        </section>
      </div>
      <div class="settings-pane" data-pane="agents">
        <section class="card panel" id="agents-panel">
          <div class="panel-head">
            <div>
              <h2>AGENTS.md</h2>
              <p class="muted" style="margin:4px 0 0;">Canonical instructions synced to hosts at <code>~/.codex/AGENTS.md</code></p>
            </div>
            <div class="panel-actions" style="gap:10px; align-items:center;">
              <span class="muted" id="agentsMeta"></span>
              <button class="ghost tiny-btn" id="editAgentsBtn">Edit</button>
            </div>
          </div>
          <div class="agents-preview" id="agentsPreview">Loading…</div>
        </section>
      </div>

      <div class="settings-pane" data-pane="prompts">
        <div class="modal-backdrop" id="promptModal">
          <div class="modal prompt-modal">
            <h3 id="promptModalTitle">Slash Command</h3>
            <div class="field">
              <label for="promptFilename" style="font-weight:600;">Filename</label>
              <input id="promptFilename" type="text" placeholder="example.sh">
            </div>
            <div class="field">
              <label for="promptDescription" style="font-weight:600;">Description</label>
              <input id="promptDescription" type="text" placeholder="Short summary">
            </div>
            <div class="field">
              <label for="promptArgument" style="font-weight:600;">Argument (optional)</label>
              <input id="promptArgument" type="text" placeholder="e.g. hostname">
            </div>
            <div class="field">
              <label for="promptBody" style="font-weight:600;">Body</label>
              <textarea id="promptBody" rows="10" placeholder="Slash command prompt…"></textarea>
            </div>
            <div id="promptStatus" class="muted" style="min-height:18px; font-size:13px;"></div>
            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:6px;">
              <button class="ghost" id="promptCancel">Cancel</button>
              <button id="promptSave">Save</button>
            </div>
          </div>
        </div>
        <section class="card panel" id="prompts-panel">
          <div class="panel-head">
            <div>
              <h2>Slash Commands</h2>
              <p class="muted" style="margin:4px 0 0;">Server-stored prompts baked into hosts (synced by cdx)</p>
            </div>
            <div class="panel-actions">
              <button class="ghost tiny-btn" id="newCommandBtn">+ New Command</button>
            </div>
          </div>
          <div class="table-wrap">
            <table id="prompts">
              <thead>
                <tr>
                  <th>Filename</th>
                  <th>Description</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>
      </div>

      <div class="settings-pane" data-pane="memories">
        <section class="card panel" id="memories-panel">
          <div class="panel-head">
            <div>
              <h2>Memories</h2>
              <p class="muted" style="margin:4px 0 0;">Browse MCP memories stored by hosts.</p>
            </div>
            <div class="panel-actions" style="gap:10px;">
              <a class="ghost tiny-btn" href="/admin/mcp-logs.html" style="text-decoration:none;line-height:28px;">Access Logs</a>
              <button class="ghost tiny-btn" id="memoriesRefreshBtn">Refresh</button>
            </div>
          </div>
          <div class="memory-controls" id="memoriesFilters">
            <div class="field">
              <label for="memoriesQuery" style="font-weight:600;">Search</label>
              <input id="memoriesQuery" type="text" placeholder="Text search (optional)">
            </div>
            <div class="field narrow-field">
              <label for="memoriesHostFilter" style="font-weight:600;">Host</label>
              <select id="memoriesHostFilter">
                <option value="">All hosts</option>
              </select>
            </div>
            <div class="field">
              <label for="memoriesTags" style="font-weight:600;">Tags</label>
              <input id="memoriesTags" type="text" placeholder="tag1, tag2 (optional)">
            </div>
            <div class="field narrow-field">
              <label for="memoriesLimit" style="font-weight:600;">Limit</label>
              <input id="memoriesLimit" type="number" min="1" max="200" value="50">
            </div>
          </div>
          <div class="table-wrap" id="memoriesTableWrap">
            <table id="memories">
              <thead>
                <tr>
                  <th>Content</th>
                  <th>Tags</th>
                  <th>Updated</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>
      </div>

      <div class="settings-pane" data-pane="config">
        <section class="card panel" id="config-panel">
          <div class="panel-head">
            <div>
              <h2>config.toml Builder</h2>
              <p class="muted" style="margin:4px 0 0;">Generate, preview, and deploy the fleet-wide config.</p>
            </div>
            <div class="panel-actions">
              <button id="renderConfig" class="ghost tiny-btn">Preview</button>
              <button id="saveConfig" class="primary">Save &amp; Deploy</button>
            </div>
          </div>
          <div class="panel-body">
            <div class="inline-group" style="margin-bottom:12px;">
              <div class="pill-quiet">Status: <span id="configStatus">Loading…</span></div>
              <div class="pill-quiet">SHA: <span id="configSha">—</span></div>
              <div class="pill-quiet">Updated: <span id="configUpdated">—</span></div>
            </div>
            <div class="config-grid">
              <div class="config-card">
                <h3>Model &amp; Behavior</h3>
                <p>Pick the model and how it reasons, responds, and sizes outputs.</p>
                <div class="field">
                  <label for="modelInput">Model</label>
                  <select id="modelInput">
                    <option value="gpt-5.1-codex">gpt-5.1-codex</option>
                    <option value="gpt-5.1-codex-max">gpt-5.1-codex-max</option>
                    <option value="gpt-5.1-codex-mini">gpt-5.1-codex-mini</option>
                    <option value="gpt-5.1">gpt-5.1</option>
                  </select>
                </div>
                <div class="inline-group">
                  <div class="field">
                    <label for="reasoningEffortInput">Model Reasoning Effort</label>
                    <select id="reasoningEffortInput">
                      <option value="">—</option>
                      <option value="low">low</option>
                      <option value="medium">medium</option>
                      <option value="high">high</option>
                      <option value="xhigh">xhigh</option>
                    </select>
                  </div>
                  <div class="field">
                    <label for="reasoningSummaryInput">Reasoning Summary</label>
                    <select id="reasoningSummaryInput">
                      <option value="">—</option>
                      <option value="auto">auto</option>
                      <option value="concise">concise</option>
                      <option value="detailed">detailed</option>
                    </select>
                  </div>
                  <div class="field">
                    <label for="verbosityInput">Verbosity</label>
                    <select id="verbosityInput">
                      <option value="">—</option>
                      <option value="low">low</option>
                      <option value="medium">medium</option>
                      <option value="high">high</option>
                    </select>
                  </div>
                </div>
                <div class="inline-group">
                  <div class="field">
                    <label for="contextWindowInput">Context Window</label>
                    <input id="contextWindowInput" type="number" min="0" placeholder="e.g. 128000">
                  </div>
                  <div class="field">
                    <label for="maxTokensInput">Max Output Tokens</label>
                    <input id="maxTokensInput" type="number" min="0" placeholder="e.g. 4096">
                  </div>
                  <div class="field">
                    <label style="align-items:center; gap:8px;">
                      <span>Force reasoning summaries</span>
                      <input id="supportsSummariesInput" type="checkbox" style="width:auto; accent-color: var(--accent);">
                    </label>
                  </div>
                </div>
                <div class="field">
                  <label for="notifyInput">Notify command</label>
                  <textarea id="notifyInput" placeholder="One argument per line, e.g.&#10;python3&#10;/path/to/notify.py"></textarea>
                  <div class="muted-note">Maps to <code>notify = [\"arg1\",\"arg2\",...]</code>.</div>
                </div>
              </div>

              <div class="config-card">
                <h3>Security &amp; Features</h3>
                <p>Guardrails plus the extras you want surfaced to users.</p>
                <div class="field">
                  <label for="approvalPolicyInput">Approval policy</label>
                  <select id="approvalPolicyInput">
                    <option value="on-request">on-request</option>
                    <option value="untrusted">untrusted</option>
                    <option value="on-failure">on-failure</option>
                    <option value="never">never</option>
                  </select>
                </div>
                <div class="feature-list">
                  <label class="feature-toggle">
                    <input type="checkbox" id="featureStreamShell" style="width:auto; accent-color: var(--accent);">
                    <div>
                      <div class="feature-title">Stream shell output</div>
                      <div class="feature-desc">Show long-running command output live instead of in one big dump.</div>
                    </div>
                  </label>
                  <label class="feature-toggle">
                    <input type="checkbox" id="featureWebSearch" style="width:auto; accent-color: var(--accent);">
                    <div>
                      <div class="feature-title">Allow web search</div>
                      <div class="feature-desc">Let Codex reach out for fresh context when it needs it.</div>
                    </div>
                  </label>
                  <label class="feature-toggle">
                    <input type="checkbox" id="featureViewImage" style="width:auto; accent-color: var(--accent);" checked>
                    <div>
                      <div class="feature-title">Allow image viewer</div>
                      <div class="feature-desc">Preview images directly in the conversation instead of downloading them.</div>
                    </div>
                  </label>
                </div>
                <div class="field">
                  <label for="extraFeaturesInput">Advanced flags (optional)</label>
                  <textarea id="extraFeaturesInput" placeholder='feature_name=true or JSON object e.g. {"feature":true}'></textarea>
                  <div class="muted-note">For niche toggles. One per line works, or drop in a JSON object.</div>
                </div>
              </div>

              <div class="config-card">
                <h3>Sandbox &amp; Environment</h3>
                <p>Control workspace access, env visibility, and permissions.</p>
                <div class="field">
                  <label for="sandboxModeInput">Sandbox mode</label>
                  <select id="sandboxModeInput">
                    <option value="workspace-write">workspace-write</option>
                    <option value="read-only">read-only</option>
                    <option value="danger-full-access">danger-full-access</option>
                  </select>
                </div>
                <div class="feature-list">
                  <label class="feature-toggle">
                    <input type="checkbox" id="sandboxNetwork" style="width:auto; accent-color: var(--accent);">
                    <div>
                      <div class="feature-title">Allow network access</div>
                      <div class="feature-desc">Let workspace commands reach the internet. Turn off for air-gapped runs.</div>
                    </div>
                  </label>
                  <label class="feature-toggle">
                    <input type="checkbox" id="sandboxTmpdir" style="width:auto; accent-color: var(--accent);">
                    <div>
                      <div class="feature-title">Exclude $TMPDIR</div>
                      <div class="feature-desc">Skip the host's $TMPDIR to keep temp files private.</div>
                    </div>
                  </label>
                  <label class="feature-toggle">
                    <input type="checkbox" id="sandboxSlashTmp" style="width:auto; accent-color: var(--accent);">
                    <div>
                      <div class="feature-title">Exclude /tmp</div>
                      <div class="feature-desc">Hide /tmp from the sandbox to avoid leaking host temp artifacts.</div>
                    </div>
                  </label>
                </div>
                <div class="field">
                  <label for="writableRootsInput">Writable roots</label>
                  <textarea id="writableRootsInput" placeholder="/path/one&#10;/path/two"></textarea>
                </div>
                <div class="field">
                  <label for="envInheritInput">Shell env inherit</label>
                  <input id="envInheritInput" type="text" placeholder="safe | none | full">
                </div>
                <div class="field">
                  <label for="envIncludeInput">Include only</label>
                  <textarea id="envIncludeInput" placeholder="PATH&#10;HOME"></textarea>
                </div>
                <div class="field">
                  <label for="envExcludeInput">Exclude patterns</label>
                  <textarea id="envExcludeInput" placeholder="AWS_*&#10;AZURE_*"></textarea>
                </div>
                <div class="field">
                  <label for="envSetInput">Set env (key=value per line)</label>
                  <textarea id="envSetInput" placeholder="PATH=/usr/bin&#10;MY_FLAG=1"></textarea>
                </div>
                <label class="feature-toggle" style="margin-top:6px;">
                  <input type="checkbox" id="ignoreDefaultExcludesInput" style="width:auto; accent-color: var(--accent);">
                  <div>
                    <div class="feature-title">Ignore default env excludes</div>
                    <div class="feature-desc">Skip the built-in env blacklist (AWS_*, etc.); only the filters you set above will apply.</div>
                  </div>
                </label>
              </div>

              <div class="config-card">
                <h3>Profiles</h3>
                <p>Define multiple profiles for different host roles.</p>
                <div class="row-actions">
                  <button class="ghost tiny-btn" id="addProfileBtn">+ Add profile</button>
                  <span class="muted-note">Profiles render under <code>[profiles."name"]</code></span>
                </div>
                <div class="list-rows" id="profileRows"></div>
              </div>

              <div class="config-card">
                <h3>MCP Servers</h3>
                <p>Servers baked into config.toml; hosts sync them automatically.</p>
                <div class="row-actions">
                  <button class="ghost tiny-btn" id="addMcpBtn">+ Add MCP</button>
                  <span class="muted-note">Count: <span id="mcpCount">0</span></span>
                </div>
                <details class="mcp-accordion" id="mcpAccordion" open>
                  <summary><span id="orchestratorMcpSummary">Managed MCP (auto)</span><span class="muted" id="orchestratorMcpSummaryWrap">Loading…</span></summary>
                  <div class="list-rows" id="mcpRows"></div>
                </details>
              </div>

              <div class="config-card">
                <h3>OTEL &amp; Observability</h3>
                <p>Telemetry wiring for OTEL exporters.</p>
                <div class="field">
                  <label for="otelExporterInput">Exporter</label>
                  <input id="otelExporterInput" type="text" placeholder="otlphttp">
                </div>
                <div class="inline-group">
                  <div class="field">
                    <label for="otelEndpointInput">Endpoint</label>
                    <input id="otelEndpointInput" type="text" placeholder="https://otel.example.com/v1/logs">
                  </div>
                  <div class="field">
                    <label for="otelProtocolInput">Protocol</label>
                    <input id="otelProtocolInput" type="text" placeholder="http/protobuf">
                  </div>
                  <div class="field">
                    <label for="otelHeadersInput">Headers</label>
                    <textarea id="otelHeadersInput" placeholder="X-API-KEY=..."></textarea>
                  </div>
                </div>
                <label class="feature-toggle" style="margin-top:6px;">
                  <input type="checkbox" id="otelLogPromptsInput" style="width:auto; accent-color: var(--accent);">
                  <div>
                    <div class="feature-title">Log prompts</div>
                    <div class="feature-desc">Send prompts to OTEL; disable to log metadata only.</div>
                  </div>
                </label>
              </div>

              <div class="config-card">
                <h3>Custom TOML</h3>
                <p>Paste raw TOML to append verbatim to the rendered file.</p>
                <div class="field">
                  <label for="customTomlInput">Custom TOML</label>
                  <textarea id="customTomlInput" placeholder="# extra config"></textarea>
                </div>
              </div>
            </div>
            <div class="config-card" style="margin-top:14px;">
              <div class="preview-actions">
                <p class="tagline">Preview of rendered config.toml</p>
                <div class="row-actions">
                  <button class="ghost tiny-btn" id="copyPreview">Copy</button>
                </div>
              </div>
              <div class="mono-block" id="configPreview">Waiting for render…</div>
              <div class="muted" id="previewMeta" style="margin-top:6px;">—</div>
            </div>
          </div>
        </section>
      </div>
    </main>
    </div>
  </div>
  <script src="nav.js?v=2025-12-08-06"></script>
  <script src="dashboard.js?v=2025-12-09-03"></script>
  <script src="config.js?v=2025-12-06-03"></script>
  <script>
    (() => {
      const tabs = Array.from(document.querySelectorAll('.settings-tab'));
      const panes = Array.from(document.querySelectorAll('.settings-pane'));
      const activate = (name) => {
        tabs.forEach(t => t.classList.toggle('active', t.dataset.tab === name));
        panes.forEach(p => p.classList.toggle('active', p.dataset.pane === name));
      };
      tabs.forEach(t => t.addEventListener('click', (e) => {
        e.preventDefault();
        activate(t.dataset.tab);
      }));
    })();
  </script>
</body>
</html>
